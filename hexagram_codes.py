# 卦象编码
# 0代表阴爻，1代表阳爻，从初爻到上爻

# 卦象名称和编码的映射字典
HEXAGRAM_CODES = {
    "乾为天卦": "111111",  # 乾
    "坤为地卦": "000000",  # 坤
    "水雷屯卦": "010001",  # 屯
    "山水蒙卦": "100010",  # 蒙
    "水天需卦": "010111",  # 需
    "天水讼卦": "111010",  # 讼
    "地水师卦": "000010",  # 师
    "水地比卦": "010000",  # 比
    "风天小畜卦": "110111",  # 小畜
    "天泽履卦": "111011",  # 履
    "地天泰卦": "000111",  # 泰
    "天地否卦": "111000",  # 否
    "天火同人卦": "111101",  # 同人
    "火天大有卦": "101111",  # 大有
    "地山谦卦": "000100",  # 谦
    "雷地豫卦": "001000",  # 豫
    "泽雷随卦": "011001",  # 随
    "山风蛊卦": "100110",  # 蛊
    "地泽临卦": "000011",  # 临
    "风地观卦": "110000",  # 观
    "火雷噬嗑卦": "101001",  # 噬嗑
    "山火贲卦": "100101",  # 贲
    "山地剥卦": "100000",  # 剥
    "地雷复卦": "000001",  # 复
    "天雷无妄卦": "111001",  # 无妄
    "山天大畜卦": "100111",  # 大畜
    "山雷颐卦": "100001",  # 颐
    "泽风大过卦": "011110",  # 大过
    "坎为水卦": "010010",  # 坎
    "离为火卦": "101101",  # 离
    "泽山咸卦": "011100",  # 咸
    "雷风恒卦": "001110",  # 恒
    "天山遁卦": "111100",  # 遁
    "雷天大壮卦": "001111",  # 大壮
    "火地晋卦": "101000",  # 晋
    "地火明夷卦": "000101",  # 明夷
    "风火家人卦": "110101",  # 家人
    "火泽睽卦": "101011",  # 睽
    "水山蹇卦": "010100",  # 蹇
    "雷水解卦": "001010",  # 解
    "山泽损卦": "100011",  # 损
    "风雷益卦": "110001",  # 益
    "泽天夬卦": "011111",  # 夬
    "天风姤卦": "111110",  # 姤
    "泽地萃卦": "011000",  # 萃
    "地风升卦": "000110",  # 升
    "泽水困卦": "011010",  # 困
    "水风井卦": "010110",  # 井
    "泽火革卦": "011101",  # 革
    "火风鼎卦": "101110",  # 鼎
    "震为雷卦": "001001",  # 震
    "艮为山卦": "100100",  # 艮
    "风山渐卦": "110100",  # 渐
    "雷泽归妹卦": "001011",  # 归妹
    "雷火丰卦": "001101",  # 丰
    "火山旅卦": "101100",  # 旅
    "巽为风卦": "110110",  # 巽
    "兑为泽卦": "011011",  # 兑
    "风水涣卦": "110010",  # 涣
    "水泽节卦": "010011",  # 节
    "风泽中孚卦": "110011",  # 中孚
    "雷山小过卦": "001100",  # 小过
    "水火既济卦": "010101",  # 既济
    "火水未济卦": "101010"   # 未济
}

# 反向映射：从编码到卦象名称
CODE_TO_HEXAGRAM = {code: name for name, code in HEXAGRAM_CODES.items()}

def get_hexagram_code(hexagram_name):
    """根据卦象名称获取编码"""
    return HEXAGRAM_CODES.get(hexagram_name)

def get_hexagram_name(code):
    """根据编码获取卦象名称"""
    return CODE_TO_HEXAGRAM.get(code)

def calculate_changed_hexagram(original_code, changing_lines):
    """计算变卦
    
    Args:
        original_code: 原卦的编码，如"111010"
        changing_lines: 动爻的列表，从1开始，如[1, 3, 5]表示初爻、三爻、五爻动
    
    Returns:
        变卦的编码
    """
    if not changing_lines:
        return original_code
    
    result = list(original_code)
    for line in changing_lines:
        # 注意：爻的编号从1开始，但索引从0开始，且从下往上数
        index = 6 - line  # 转换为从0开始的索引
        # 阴变阳，阳变阴
        result[index] = '0' if result[index] == '1' else '1'
    
    return ''.join(result)

def calculate_inverse_hexagram(code):
    """计算综卦（上下卦的颠倒）"""
    upper = code[0:3]
    lower = code[3:6]
    return lower + upper

def calculate_mutual_hexagram(code):
    """计算交互卦（由第2、3、4爻作为下卦，3、4、5爻作为上卦组成）"""
    # 取第3、4、5爻（从下往上数，对应索引3、2、1）作为上卦
    upper_trigram = code[1:4]
    # 取第2、3、4爻（从下往上数，对应索引4、3、2）作为下卦
    lower_trigram = code[2:5]
    # 构建新的六爻卦（上卦+下卦）
    return upper_trigram + lower_trigram

# 一撮金句子字典
# 格式：{卦名: {爻位: 句子内容}}
# 爻位使用数字1-6表示初爻到上爻
YICUOJIN_SENTENCES = {
    "乾为天卦": {
        2: "九二二爻上上：得意宜逢贵，前程去有缘。利名终有望，三五月团圆。",
        4: "九四四爻中中：欲行不止，徘徊不已。藏玉怀珠，片帆千里。",
        6: "上九六爻下下：心戚戚，口啾啾。一番思量一番忧，说了休时又不休。"
    },
    "天泽履卦": {
        1: "初九初爻上中：不远不近，似易似难。等闲入手，云中笑看。",
        3: "六三三爻下下：桃李谢春风，西去又复东。家中无意绪，船在浪涛中。",
        5: "九五五爻中中：狂风吹起黑云飞，月在天心遮不得。时闲无事暂相关，到底依然无刻剥。"
    },
    "天火同人卦": {
        2: "六二二爻上上：心和同，事和同，门外好施工，交加事有终。",
        4: "九四四爻中平：意孜孜，心戚戚，要平安，防出入。",
        6: "上九六爻上中：一水绕一水，一山绕一山。水尽山穷处，名利不为难。"
    },
    "天雷无妄卦": {
        1: "初九初爻上上：事扛扶，在半途，翻覆终可免，风波一点无。",
        3: "六三三爻下下：浅水起波澜，平地生荆棘。言语虚参商，犹恐无端的。",
        5: "九五五爻上上：喜喜喜，春风生桃李。不用强忧煎，明月人千里。"
    },
    "天风姤卦": {
        2: "九二二爻下中：欲济未济，欲求强求。心无一定，一车两头。",
        4: "九四四爻下下：居下当亲上，人心易散离。事械才一失，万事尽皆灭。",
        6: "上九六爻下下：见不见，也防人背面。遇不遇，到底无凭据。"
    },
    "天水讼卦": {
        1: "初六初爻上中：嘹呖征鸿独出群，高飞羽翼更斜云。分程正北堪图进，好个名声处处闻。",
        3: "六三三爻上中：贵各相逢便可期，庭前枯木凤来仪。好将短事求长事，休听旁人说是非。",
        5: "九五五爻上上：檐前鹊噪正翩翩，忧虑洗消喜自然。一个进了一个退，下梢总有好因缘。"
    },
    "天山遁卦": {
        2: "六二二爻中中：兀兀尘埃又待时，幽窗静处有谁知。若逢青紫人相引，财利功名自可期。",
        4: "九四四爻上中：一得一虑，宜后欲先。路通大道，心事安然。",
        6: "上九六爻上上：一番桃李一番新，谁识阳和气象明。林下水边多活计，见山了了称人情。"
    },
    "天地否卦": {
        1: "初六初爻上中：相引更相牵，殷勤喜自然。施为无不利，愁事变团圆。",
        3: "六三三爻下下：无踪又无迹，远近终难觅。平地起风云，似笑还成泣。",
        5: "九五五爻下下：身不安，心不安。动静两三番，终期事必欢。"
    },
    # 添加泽卦部分
    "兑为泽卦": {
        2: "九二二爻上上：玉出昆冈石，舟离古渡滩。行藏终有望，用舍不为难。",
        4: "九四四爻下下：难难难，忽然平地起波澜。易易易，谈笑平常终有忌。",
        6: "上六六爻下下：乐之极矣悲相望，引兑来兮吉与凶。未能广大终须暗，日落西山返照中。"
    },
    "泽天夬卦": {
        1: "初九初爻下中：神黯黯，意悠悠。收却线，莫下钩。",
        3: "九三三爻中平：虎伏在前途，行人莫乱呼。路旁须仔细，灾祸自然无。",
        5: "九五五爻下下：所事纵云难，平地起波澜。笑谈终有忌，事回心觉安。"
    },
    "泽火革卦": {
        1: "初九初爻下中：意迷心不迷，事宽心不宽。要知端的事，犹隔两重山。",
        3: "九三三爻中中：道路迢遥，门庭闭塞。雪拥未分明，云开方见日。",
        5: "九五五爻上中：虎变高山别有期，望人目下尚狐疑。雁来嘹呖黄花发，此际声名达帝畿。"
    },
    "泽雷随卦": {
        2: "六二二爻中平：一事已成空，一事还成喜。若遇口边人，心下堪凭倚。",
        4: "九四四爻下中：鱼上钩，丝纶弱。收拾难，力再著。",
        6: "上六六爻上上：可蓄可收，片玉寸珠。停停稳稳，前遇良图。"
    },
    "泽风大过卦": {
        1: "初六初爻中中：心有余，力不足。倚仗春风，一歌一曲。",
        3: "九三三爻下下：荆棘生平地，风波起四方。倚阑惆怅望，无语对斜阳。",
        5: "九五五爻中中：一人两事，一人两心。新花枯树，须待交春。"
    },
    "泽水困卦": {
        2: "九二二爻上中：足不安，心不安。两两事相得，忧来又又欢。",
        4: "九四四爻上中：目下志难舒，有客来徐徐。金车虽历险，吝必有终欤。",
        6: "上六六爻下下：缺月恐难圆，残花不再鲜，苦求名与利，到处遇迍邅。"
    },
    "泽山咸卦": {
        1: "初六六爻中中：意在关中信未来，故人千里自徘徊。天边雁足传书至，一点梅花喜色开。",
        3: "九三三爻下下：休道事无论讹，其中进退多。桂轮圆又缺，光彩更揩磨。",
        5: "九五五爻下中：事了物未了，人圆物未圆。要知端的信，月影上阑干。"
    },
    "泽地萃卦": {
        2: "六二二爻上中：笑中生不足，内外见愁哭。云散月光辉，转祸当成福。",
        4: "九四四爻中中：言语参商，波涛鼎沸。事久无伤，时间不利。",
        6: "上六六爻中中：无非应有忌，未为先恐踬。路险风波事更非，要得称心须借势。"
    },
    "离为火卦": {
        2: "六二二爻上上：谋已定，事何忧。明月上重楼，云中客点头。",
        4: "九四四爻下下：遇不遇，逢不逢。月沉水底，人在梦中。",
        6: "上九六爻中中：诛战中邦利出征，一朝获丑在王庭。凤衔一诏堤场畔，得个佳名四海荣。"
    },
    "火天大有卦": {
        2: "九二二爻上中：一重水，一重山，风波道坦然，壶中别有天。",
        4: "九四四爻上上：遇险不为忧，风波何足惧。若遇草头人，咫尺青云路。",
        6: "上九六爻上上：奇奇奇，地利与天时。灯花传信后，动静总相宜。"
    },
    "火泽睽卦": {
        1: "初九初爻下中：上下分，忧愁决。千嶂云，一轮月。",
        3: "六三三爻下下：鼎沸风波，孤舟渡河。巧中藏拙，人事蹉跎。",
        5: "六五五爻下中：船棹中流急，开花春又迟。事宁心不静，惹起许多疑。"
    },
    "火雷噬嗑卦": {
        1: "初九初爻上中：人倚楼，许多愁。淡然进步，事始无忧。",
        3: "六三三爻上中：暗中防霹雳，猜疑浑未实。转眼黑云收，拥出扶桑日。",
        5: "六五五爻下下：堪叹枕边忧，更嗟门里闹。意绪甚索缠，心神亦颠倒。"
    },
    "火风鼎卦": {
        2: "九二二爻上上：小子出门庭，青衣久问程。贵人来助力，花谢子还成。",
        4: "九四四爻下中：鼎折足，舆脱辙。有贵人，重相续。",
        6: "上九六爻上上：贵客自相亲，功名唾手成。获金须积德，仰望太阳升。"
    },
    "火水未济卦": {
        1: "初六初爻中中：桑榆催晚景，缺月恐难圆。若遇刀锥客，方知有喜缘。",
        3: "三六三爻下中：万里片帆轻，波平浪不惊。行行无阴滞，远虑更通津。",
        5: "六五五爻上上：芰荷香里许恩材，桂魄圆时印绶来。从此威名山岳重，光辉玉节位三台。"
    },
    "火山旅卦": {
        2: "六二二爻上上：悲脸笑颜开，秋月挂高台，人从千里来。",
        4: "九四四爻中中：花落正逢春，行人在半程。事成还不就，索绊两三旬。",
        6: "上九六爻中中：憔悴无人问，林间听杜鹃。一声山月笛，千里暗销魂。"
    },
    "火地晋卦": {
        1: "初六初爻上中：须著力，莫游遨。长竿钓向蟾蜍窟，直欲云中得巨鳌。",
        3: "六三三爻上上：两两意和同，轻帆遇顺风。道逢人得意，歌唱急流中。",
        5: "六五五爻中中：万里涉江山，风波尽日闲。已吞钩上饵，何必遇波澜。"
    },

    "震为雷卦": {
        2: "六二二爻下下：无踪又无迹，远近终难觅。旱海莫行舟，何劳空著力。",
        4: "九四四爻上中：白玉隐尘，黄金埋土。久久光辉，也要人举。",
        6: "上六六爻下中：细雨濛濛湿，江边路不通。道途人未达，凭仗借东风。"
    },
    "雷天大壮卦": {
        1: "初九初爻下下：江阔渡无船，惊涛恐拍天。月斜云淡处，音信有人传。",
        3: "三九三爻下中：平地起风烟，时下未能安，高处觅因缘。",
        5: "六五五爻下中：正直宜守，妄动生灾。名通利达，叶落花开。"
    },
    "雷泽归妹卦": {
        2: "九二二爻下中：门外事重叠，阴人多遇合。贤女虽助巧，渺渺终难洽。",
        4: "九四四爻下中：缺月重圆，枯枝又鲜。一条坦路，翘首青天。",
        6: "上六六爻中中：美红颜，休挂怀。人在车中，舟行海底。"
    },
    "雷火丰卦": {
        1: "初九初爻上中：过尽风波三五重，谁知浪尽又无风。须知明达青云路，用舍行藏不费功。",
        3: "九三三爻下下：纷纷复纷纷，欷嘘独掩门。敛眉望灯火，伴我坐黄昏。",
        5: "六五五爻下中：门内佳音来，生涯应有庆。名利有更迁，雁行终拆阵。"
    },
    "雷风恒卦": {
        1: "初六初爻下下：深潭月，明镜影。一场空，妄报信。",
        3: "九三三爻下下：桥已断，路不通。登舟理楫，又遇狂风。",
        5: "六五五爻下下：湖水悠悠，孤舟浪头。来人未识，残月山楼。"
    },
    "雷水解卦": {
        2: "九二二爻上上：万里波涛静，一天风雨闲。利名无阻隔，行路出重关。",
        4: "九四四爻上上：湖海意悠悠，烟波下钓钩。若逢龙与兔，名利一齐周。",
        6: "上六六爻上中：一箭青云路，营求指日成。许多闲口语，翻作笑歌声。"
    },
    "雷山小过卦": {
        1: "初六初爻下下：物不牢，人断桥。重整理，慢心高。",
        3: "九三三爻下下：深户要牢扃，须防暗里人。莫言无外事，纵好定遭迍。",
        5: "六五五爻上上：空空空，空里得成功。蟠桃千年熟，不怕五更风。"
    },
    "雷地豫卦": {
        2: "六二二爻中中：凿石得玉，淘沙得珠。眼前目下，何用踌躇。",
        4: "九四四爻上上：名成利遂勿忧煎，菊里秋风道坦然。得意便垂三尺钓，长竿获得锦鳞鲜。",
        6: "上六六爻下下：独钓寒潭涧，中途兴已阑。水寒鱼不饵，小艇月明还。"
    },

    "巽为风卦": {
        2: "九二二爻下下：无踪又无迹，远近终难觅。旱海莫行舟，何劳空费力。",
        4: "陆肆四爻上上：江海悠悠，烟波下钩。六鳌连获，歌笑中流。",
        6: "上九六爻下下：一月圆，一镜缺。少团圆，无可说。"
    },
    "风天小畜卦": {
        2: "九二二爻上中：金鳞入手，得还防走。若论周旋，谨慎戒口。",
        4: "陆肆四爻中中：上下不和同，劳而未有功。出门通大道，从此何初终。",
        6: "上九六爻上中：拟欲迁而未可迁，提防喜处惹勾连。前途若得阴人引，变化鱼龙出大渊。"
    },
    "风泽中孚卦": {
        1: "初九初爻上中：一点著阳春，枯枝朵朵荣。志专方遇合，初忌二三心。",
        3: "六三三爻中中：欲行迁止，徘徊不已。动摇莫强，得止且止。",
        5: "九五五爻上上：倾一杯，转愁眉。天地合，好施为。"
    },
    "风火家人卦": {
        2: "六二二爻下中：一镜破，照两人。心中结，合同心。",
        4: "陆肆四爻上上：珠玉走盘中，田园足阜丰。休言谋未遂，此去一时通。",
        6: "上九六爻上中：心下事悠然，周旋尚未全。遇龙终有吉，人月永团圆。"
    },
    "风雷益卦": {
        1: "初九初爻上中：大事可成功，有益还无咎。云内执鞭人，报在三秋后。",
        3: "六三三爻下下：无踪又无迹，远近终难觅。旱海莫行舟，何劳空费力。",
        5: "九五五爻上上：子结花残，花开枯树。屋头春意喜，笑嘻嘻。"
    },
    "风水涣卦": {
        1: "初六初爻上上：云静日当中，光辉到处通。道途逢水源，千里快如风。",
        3: "六三三爻中中：望处应重山，高深渐可攀。举头天上看，明月出人间。",
        5: "九五五爻中中：不归一，劳心力。贵人旁，宜借力。"
    },
    "风山渐卦": {
        2: "六二二爻上上：阆苑一时春，庭前花柳新。鹊声传好信，草木自欣欣。",
        4: "陆肆四爻上上：欲捉月中兔，须凭桃李梯。高山来接引，双喜照双眉。",
        6: "上九六爻中中：意迷心不迷，事宽心不宽。一场双喜会，不久出重关。"
    },
    "风地观卦": {
        1: "初六六爻上上：野鬼暗张弧，射中主人惊。红日沉江海，空中事不成。",
        4: "陆肆四爻上上：双燕衔书舞，指日一齐来。寂寞淹留客，从兹下钓台。",
        5: "九五五爻下中：云叆叆，月朦朦。一雁入云中，残花谢晓风。"
    },
    
    # 添加坎为水卦部分
    "坎为水卦": {
        2: "九二二爻下中：梦里说江水，波深下钓难。利名终有望，目下未开颜。",
        4: "陆肆四爻上上：莫怪事迟留，休言不到头。长竿终入手，一钓上金钩。",
        6: "上九六爻下下：疑疑疑，一番笑后一番悲。落红满地无人扫，独对西风扶黛眉。"
    },
    "水天需卦": {
        1: "初九初爻上中：过尽山前后，艰阻往来难。若得清风便，扁舟过远山。",
        3: "九三三爻上中：君子升，小人阻。征战生离苦。前途自有吉人逢，信在马羊人在楚。事可忧？要营求。",
        5: "九五五爻中中：久历惊涛，东风便好。太平身退，目下尚早。"
    },
    "水泽节卦": {
        2: "九二二爻下下：休眷恋，奔前程。终闹乱，出门庭。",
        4: "陆肆四爻上上：用则行，舍则藏。一骑出重关，佳音咫尺间。",
        6: "上六六爻下下：渴穿井，饥画饼。漫劳心，如捕影。遇龙虎，方可省。"
    },
    "水火既济卦": {
        1: "初九初爻上上：鹿逐云中出，人从月下归。新欣盈笑脸，不用皱双眉。",
        3: "九三三爻上中：入易而难，出而难。厌厌到再三，交加意不堪。",
        5: "九五五爻中中：积德施功有子孙，杀牛祭佛及西邻。功名两字垂成日，回首山前万物新。"
    },
    "水雷屯卦": {
        2: "六二二爻上中：事迟志速，而且反复。直待岁寒，花残果熟。",
        4: "陆肆四爻上上：乘马班如，求婚媾吉。随时谐义，缺月重明。",
        6: "上六六爻下下：不足不足，难伸心曲。野塘雨过，月如钩，梦断邯郸眉黛蹙。"
    },
    "水风井卦": {
        1: "初六初爻中中：月在云间，昏迷道路。云散月明，渐宜进步。",
        3: "九三三爻下下：安静事难疑，云中一鹤飞。桃花逢骤雨，水畔女频啼。",
        5: "九五五爻上中：美在甘，甘有香。始有终，终有始。"
    },
    "水山蹇卦": {
        1: "初六初爻下中：岸阔水深舟易落，路遥山险步难行。行行自有通津日，目下香消月未明。",
        3: "九三三爻下下：事虑淹留，人不彻头。往来闭塞，要见无由。",
        5: "九五五爻中中：道路任招呼，风波一点无。时间心绪乱，全仗贵人扶。"
    },
    "水地比卦": {
        2: "六二二爻中中：一人去，一人来。清风明月两相猜，获得金鳞下钓台。",
        4: "陆肆四爻下中：无端风雨吹春去，落尽枝头桃李花。枕畔有人歌且笑，教君心事乱如麻。",
        6: "上六六爻下下：喜未稳，愁已遭。大雨狂风临古木，人人尽道不坚牢。"
    },


    # 添加艮为山卦部分
    "艮为山卦": {
        2: "六二二爻中中：易非易，难非难。忽然平地起波澜，歌笑须教三两番。",
        4: "陆肆六爻中中：山山有路，有终有始。似月似花，守成而已。",
        6: "上九六爻上上：宝镜无尘染，金貂已剪裁。也逢天意合，终不染尘埃。"
    },
    "山天大畜卦": {
        2: "九二二爻中中：蜗角蝇头利，而今已变通。草头人笑后，宜始不宜终。",
        4: "陆肆四爻下中：鹊噪高枝上，人行古渡头。半途不了事，日暮转生愁。",
        6: "上九六爻上上：事有喜，物有光。始终好商量，壶中日月长。"
    },
    "山泽损卦": {
        1: "初九初爻下中：喜喜喜，终防否。获得骊龙颔下珠，忽然失却还沉水。",
        3: "六三三爻中中：事未完，心未安。疑虑久，得安然。",
        5: "六五五爻中中：莫言枳棘恶，终为鸾凤栖。目前应有待，何用早踌躇。"
    },
    "山火贲卦": {
        2: "六二二爻上上：月已圆，花再发。事悠悠，无不合。",
        4: "陆肆四爻上中：曲中应有直，心事还成戚。云散月重圆，千里风帆急。",
        6: "上九六爻上上：明月重圆，颜色欣然。风云相送，和合万年。"
    },
    "山雷颐卦": {
        1: "初九初爻下下：红叶无颜色，凋零一夜风。邻鸡醒午梦，心事总成空。",
        3: "六三三爻下下：事宜休，理多错。日掩云中，空成担阁。",
        5: "六五五爻下中：进不安，退不可。上下相从，明珠一颗。"
    },
    "山风蛊卦": {
        2: "九二二爻上中：暗去又明来，忧心事可谐。终须成一笑，日下莫疑猜。",
        4: "陆肆四爻中中：可以委，可以托。事迟迟，无差错。",
        6: "上九六爻上中：深渊鱼可钓，幽林鸟可疾。只用久长心，不用生疑惑。"
    },
    "山水蒙卦": {
        1: "初六初爻下中：门外起干戈，亲朋两不和。朱衣临日月，始觉笑呵呵。",
        3: "六三三爻下下：娶女无攸利，花间又及秋。严霜将荐至，退步不存留。",
        5: "六五五爻下下：乘病马上，危坡防失，跌见蹉跎。"
    },
    "山地剥卦": {
        1: "初六初爻下下：上接不稳，下接不和。相缠相扰，平地风波。",
        3: "六三三爻上上：玉石犹蒙昧，那堪小悔多。终无咎，笑呵呵。",
        5: "六五五爻中中：圆又缺，缺又圆，低低密密要周旋，时来始见缘。"
    },

    # 添加坤为地卦部分
    "坤为地卦": {
        2: "六二二爻上上：师征千里福绵绵，造化生成信自然。功名得就神明助，蛇鬼相逢自变迁。万顷波涛无点化，一天风月更幽闲。大明在在红轮照，名利何须自作难。",
        4: "陆肆四爻下下：路不通，门闭塞。谨慎提防，月藏云黑。",
        6: "上六六爻下中：月缺花残，镜破钗分。休来休往，事始安宁。"
    },
    "地天泰卦": {
        1: "初九初爻上中：东边事，西边成。风物月华明，高楼弄笛声。",
        3: "九三三爻下下：和不和，同不同，翻云覆雨几成空，进退须防终少功。",
        5: "六五五爻上上：添一人，获一宝。事团圆，门外讨。"
    },
    "地泽临卦": {
        2: "九二二爻上上：和合事，笑谈成。好音在半程，平步踏青云。",
        4: "陆肆四爻上上：事团圆，物周旋。一往一来，平步青天。",
        6: "上六六爻上中：朦胧秋月映朱扃，林处鸡声远处生。自有贵人相接引，何须巧语似流莺。"
    },
    "地火明夷卦": {
        1: "初九初爻中中：乘翼遥飞去，皆因避远行。一途经济意，又是满园春。",
        3: "九三三爻上中：虚名虚位久沉沉，禄马当头未见真。一片彩云秋后至，去年风物一时新。",
        5: "六五五爻下下：重关深锁闭，谨慎要提防。小节不知戒，因循成大殃。"
    },
    "地雷复卦": {
        2: "六二二爻上中：悲后笑嘻嘻，中行道最宜。所求终有望，不必皱双眉。",
        4: "陆肆四爻上中：临渊放钓，清绝点埃。巨鳌随得，何用疑猜。",
        6: "上六六爻下下：进步且徘徊，春风柳絮催。水边行客倦，枕畔有忧怀。"
    },
    "地风升卦": {
        1: "初六初爻上上：明月为钩，清风作线。举网烟波，锦鳞易见。",
        3: "九三三爻上中：舟离古渡月离云，人出重关好问津。且向前行求去住，何须疑虑两三旬。",
        5: "六五五爻上上：佳信至，见笑颜。飞腾一去，披云上天。"
    },
    "地水师卦": {
        2: "九二二爻上上：秋月云开后，薰风雨过时。若逢楚国旧知己，等闲一荐不须疑。",
        4: "陆肆四爻下中：青氈终复旧，枝上果生风。莫谓一时喜，还疑此象凶。",
        6: "上六六爻上上：谋已定，事何忧。金鳞已上钩，功名一网收。"
    },
    "地山谦卦": {
        1: "初六初爻下中：恐怕正忧煎，忧非满目前。若逢明鉴照，挠括信空传。",
        3: "九三三爻上中：劳心慢劳心，劳心终有成。清风来借力，欢笑见前程。",
        5: "六五五爻下中：莺语燕呢喃，花开满院间。倚阑春梦觉，无语敛愁颜。"
    }
}

def get_yicuojin_sentence(hexagram_name, line_numbers):
    """获取一撮金句子
    
    Args:
        hexagram_name: 卦象名称，如"天水讼卦"
        line_numbers: 爻位列表，从1开始，如[1, 3, 5]表示初爻、三爻、五爻
    
    Returns:
        句子内容，如果未找到则返回None
    """
    result = []
    if hexagram_name in YICUOJIN_SENTENCES:
        for line_number in line_numbers:
            if line_number in YICUOJIN_SENTENCES[hexagram_name]:
                result.append(YICUOJIN_SENTENCES[hexagram_name][line_number])
    
    return "\n".join(result) if result else None

def get_line_number_from_text(line_text):
    """从动爻文本获取爻位数字
    
    Args:
        line_text: 动爻文本，如"初爻"、"二爻"等
    
    Returns:
        爻位数字，从1开始，如果未识别则返回None
    """
    line_mapping = {
        "初爻": 1,
        "二爻": 2,
        "三爻": 3,
        "四爻": 4,
        "五爻": 5,
        "上爻": 6
    }
    return line_mapping.get(line_text)

def get_changing_line_numbers(changing_lines_text):
    """从动爻文本获取爻位数字列表
    
    Args:
        changing_lines_text: 动爻文本，如"初爻、三爻"
    
    Returns:
        爻位数字列表，从1开始
    """
    result = []
    if not changing_lines_text:
        return result
        
    for line in changing_lines_text.split("、"):
        line_number = get_line_number_from_text(line.strip())
        if line_number:
            result.append(line_number)
    return result

# 测试
if __name__ == "__main__":
    # 测试几个卦象的编码
    print("乾为天卦编码:", get_hexagram_code("乾为天卦"))  # 应该输出 111111
    print("山水蒙卦编码:", get_hexagram_code("山水蒙卦"))  # 应该输出 100010
    
    # 测试变卦计算
    original_code = get_hexagram_code("天水讼卦")  # 111010
    print("天水讼卦编码:", original_code)
    
    # 初爻动
    changed_code = calculate_changed_hexagram(original_code, [1])
    print("天水讼卦初爻动变为:", get_hexagram_name(changed_code))
    
    # 测试综卦计算
    inverse_code = calculate_inverse_hexagram(original_code)
    print("天水讼卦的综卦:", get_hexagram_name(inverse_code))
    
    # 测试交互卦计算
    mutual_code = calculate_mutual_hexagram(original_code)
    print("天水讼卦的交互卦:", get_hexagram_name(mutual_code))
